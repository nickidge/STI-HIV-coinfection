HIV_diag_dat
str_locate_all('\\.\\.\\.)
str_locate_all(this_str, '\\.\\.\\.')
this_str = 'HIV_diag_..._all'
str_locate_all(this_str, '\\.\\.\\.')
unlist(str_locate_all(this_str, '\\.\\.\\.'))
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
HIV_diag_dat
PLHIV_dat
data_pop
HIV_diag_by_time = data.frame(risk_data_to_frame('HIV_diag_aus_...'),
type='trans', dt=1, pid='HIV_diag_tot',
sti_pop='all', risk_pop='all', HIV_pop='HIV_diag', source='data', scen='')
HIV_diag_by_time
HIV_diag_by_time = data.frame(risk_data_to_frame('HIV_diag_new_...'),
type='trans', dt=1, pid='HIV_diag_tot',
sti_pop='all', risk_pop='all', HIV_pop='HIV_diag', source='data', scen='')
HIV_diag_new = data.frame(risk_data_to_frame('HIV_diag_new_...'),
diag_time = 'new',
type='trans', dt=1, pid='HIV_diag_tot',
sti_pop='all', risk_pop='all', HIV_pop='HIV_diag', source='data', scen='')
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
HIV_diag_new
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
all_dat
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
all_dat
data_wide
this = HIV_trans_log
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
Q
source("init.R", echo = T)
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
tHIV$test
this
apply(this, c(1,2), sum)
str(this)
# this = apply(this, 1, sum)
this = apply(this, c(1,2,4), sum)
str(this)
dimnames(this)[[2]]
substr(dimnames(this)[[2]], 6, 8)
dimnames(this)[[2]] = substr(dimnames(this)[[2]], 6, 8)
melt(this)
acast(melt(this), Var1 ~ Var2, fun.aggregate = sum)
melt(this)
acast(melt(this), Var1 ~ Var2, fun.aggregate = sum)
#   # this = apply(this, 1, sum)
#   this = apply(this, c(1,2), sum)
#   this = melt(this, varnames = c("t", "I_group"), variable.name="value")
#   this$risk_pop = substr(this$I_group, 3, 8)
#   this$risk_pop = substr(this$risk_pop, 1, 2)
#   thisdf = data.frame(this %>% select(-I_group), type = 'trans', dt = 1/12, pid='HIV_diag_by_pop',
#                       sti_pop = 'all', HIV_pop = 'HIV_diag_by_pop')
#   thisdf = make_annual(thisdf)
#
# } else if(key == 'HIV_diag_by_time_med'){
this = HIV_trans_log
this = this[tvec,tHIV$test,,]
# this = apply(this, 1, sum)
this = apply(this, c(1,2,4), sum)
str(this)
dimnames(this)[[2]] = substr(dimnames(this)[[2]], 6, 8)
str(this)
melt(this)
this
dimnames(this)[[2]]
this = acast(melt(this), Var1 ~ Var2 ~ Var3, fun.aggregate = sum)
colnames(this) = c('t', 'diag_time', 'med_pop', 'value')
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
this = acast(melt(this), Var1 ~ Var2 ~ Var3, fun.aggregate = sum)
colnames(this)
this
this = HIV_trans_log
this = this[tvec,tHIV$test,,]
# this = apply(this, 1, sum)
this = apply(this, c(1,2,4), sum)
dimnames(this)[[2]] = substr(dimnames(this)[[2]], 6, 8)
this
melt(acast(melt(this), Var1 ~ Var2 ~ Var3, fun.aggregate = sum))
this = melt(acast(melt(this), Var1 ~ Var2 ~ Var3, fun.aggregate = sum))
colnames(this) = c('t', 'diag_time', 'med_pop', 'value')
str(this)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
p1 = plot_uncertainty(df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_by_time_med'), colour_strat = 'med')
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/f_calibrate.R', echo=TRUE)
p1 = plot_uncertainty(df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_by_time_med'), colour_strat = 'med')
p1 = plot_uncertainty(df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_by_time_med'), colour_strat = 'med')
med_labs
df$med_pop
df
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
p1 = plot_uncertainty(df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_by_time_med'), colour_strat = 'med')
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
df
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
Q
base_df
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
base_df
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
?geom_path
source('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
source("init.R", echo = T)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
p
p
thisdf$diag_time
unique(thisdf$diag_time)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
p
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
source('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
source('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
# model_df = run_model(y0=NULL, tvec=tvec_base, modelpars=baselist, options=options)
# model_df = extr(model_df, 'popsize')
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
p
saveopen(p, 'test')
thisdf$plot
toplot
source('~/GitHub/STI-HIV-coinfection/f_calibrate.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
c
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
saveopen(p, 'test')
saveopen(p, 'test')
saveopen(p, 'test')
saveopen(p, 'test')
saveopen(p, 'test')
saveopen(p, 'test')
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
source("init.R", echo = T)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
# run base scenario (with uncertainty)
base_df = gen_uncertainty(1)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep'), colour_strat = 'med'), 'calibration1', 'plots')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'test')
saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'test')
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
library(stringi)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
library(stringr)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
saveopen(plot_uncertainty(df, toplot=c('num_cascade', 'care_cascade', 'HIV_diag_by_pop', 'HIV_prev_by_risk')), 'cal2')
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
this
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
acast(melt(this), Var1 ~ Var2 ~ Var3, fun.aggregate = sum)
this
subset(this, t == 2020)
subset(this, t == 2020)
Q
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
subset(this, t == 2000)
subset(this, t == 2020)
thisdf$plot
View(extr)
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
subset(thisdf, plot %in% c('HIV_diag_new', 'HIV_diag_old'))
base_df
str(base_df)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
trials_df
debugSource('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
trials_df
str(trials_df)
trials_df$HIV_trans_log
subset(trials_df, plot %in% c('HIV_diag_new', 'HIV_diag_old'))
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
dimnames(this)[[2]]
dimnames(this)[[2]]
melt(this)
ttt = melt(this)
ttt <<- ttt
ttt
fff = aggregate(ttt, value, sum)
ttt
aggregate(value~., data=ttt, sum)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
melt(ttt)
Q
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
subset(thisdf, t==2000)
subset(thisdf, t==2020)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
?intersect
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source("init.R", echo = T)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
substr(pop, 1, 2)
med_labs
risk_labs
risklabs
?substr
timeindex = c("new", "low")
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
thisentrycol
thiscol
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
thislist
thisentrycol
thispar
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
# calibrate model
if(!exists('cal')){
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
cal_keys = c('PLHIV', 'HIV_diag', 'care_cascade')
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
}
match(substr(pop, 1, 2), HIV_risk_labs)
timeindex
substr(pop, 4, 6)
match(substr(pop, 4, 6), timeindex)
med_labs
match(subpop, med_labs)
col
col
pop
HIV_risk_labs
match(substr(pop, 1, 2), HIV_risk_labs)
match(substr(pop, 4, 6), timeindex)
timeindex
substr(pop, 4, 6)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
thisentry
colnames(thisentry)
paste(parname, pop, subpop, sep='__')
colnames(thisentry)
thiscol
colnames(thisentry)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
HIV_p
Q
debugSource('~/GitHub/STI-HIV-coinfection/model.R', echo=TRUE)
gen_calibration(c('f_infect_HIV', 'init_prev_HIV_aus'))
this_testing
((6 * i_med) - 5) : ((6 * i_med))
Q
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
rep(1, 12)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
?data.frame
debugSource('~/GitHub/STI-HIV-coinfection/processing.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
df
df
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
Q
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/loadpars.R', echo=TRUE)
all_dat
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
thislist$num_prep
unique(thislist$num_prep)
num_prep = thislist$num_prep
final_year = tail(rownames(distinct(num_prep)), 1)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
distinct(num_prep)
num_prep = thislist$num_prep
num_prep
unique(num_prep)
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
tail(rownames(unique(num_prep)), 1)
final_prep = tail(unique(num_prep), 1)
final_prep
popsize
prop_prep = final_prep / popsize[rownames(final_prep),]
prop_prep
final_year = rownames(final_prep)
final_year
str(rownames(num_prep))
which_years = as.numeric(rownames(num_prep)) > as.numeric(final_year)
num_prep[which_years,] = prop_prep * popsize[which_years,]
prop_prep
popsize[which_years,]
as.numeric(final_year)
as.numeric(rownames(num_prep))
as.numeric(rownames(num_prep)) > as.numeric(final_year)
popsize[which_years,]
num_prep[as.numeric(rownames(num_prep)) > as.numeric(final_year),] =
prop_prep * popsize[as.numeric(rownames(popsize)) > as.numeric(final_year),]
num_prep[as.numeric(rownames(num_prep)) > as.numeric(final_year),]
which_years = rownames(num_prep)[as.numeric(rownames(num_prep)) > as.numeric(final_year)]
which_years
popsize
str(popsize)
which_years = rownames(num_prep)[as.numeric(rownames(num_prep)) > as.numeric(final_year)]
num_prep[which_years,] = prop_prep * popsize[which_years,]
num_prep[which_years,]
popsize[which_years,]
prop_prep * popsize[which_years,]
?sweep
num_prep
sweep(popsize[which_years,], 1, prop_prep, FUN="*")
sweep(popsize[which_years,], 2, prop_prep, FUN="*")
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
key
str(modelpars)
unique(modelpars)
Q
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
setwd(dirname(rstudioapi::getActiveDocumentContext()$path))
source("init.R", echo = T)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
defaultlist
debugSource('~/GitHub/STI-HIV-coinfection/pars.R', echo=TRUE)
baselist = load_time_par_sheet('timepars', deflist = defaultlist)
thislist
str(thislist)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/f_uncertainty.R', echo=TRUE)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
# saveopen(plot_uncertainty(base_df, toplot=c('num_cascade', 'care_cascade', 'HIV_diag_by_pop', 'HIV_prev_by_risk')), 'cal2')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*0.9*page_width)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
# saveopen(plot_uncertainty(base_df, toplot=c('num_cascade', 'care_cascade', 'HIV_diag_by_pop', 'HIV_prev_by_risk')), 'cal2')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*1.2*page_width)
# saveopen(plot_uncertainty(base_df, toplot=c('pop', 'PLHIV', 'HIV_diag', 'HIV_inf', 'HIV_prev', 'prop_prep', 'HIV_diag_new', 'HIV_diag_old'), colour_strat = 'med'), 'cal1')
# saveopen(plot_uncertainty(base_df, toplot=c('num_cascade', 'care_cascade', 'HIV_diag_by_pop', 'HIV_prev_by_risk')), 'cal2')
saveopen(plot_cals(base_df), 'calibration', 'plots', width=2*1.1*page_width)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
baselist$int_factor
debugSource('~/GitHub/STI-HIV-coinfection/model.R', echo=TRUE)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
debugSource('~/GitHub/STI-HIV-coinfection/model.R', echo=TRUE)
# run base scenario (with uncertainty)
base_df = gen_uncertainty(0)
str(prevdt)
source('~/GitHub/STI-HIV-coinfection/main.R', echo=TRUE)
baselist$int_factor
